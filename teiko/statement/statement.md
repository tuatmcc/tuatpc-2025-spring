# 抵抗器

## 問題文

抵抗器が接続された回路図が図 1 に示す構文規則によって与えられます。

<div align="center">

![回路図](https://hackmd.io/_uploads/SJCL7xo5ke.png)

図 1 : 構文規則

</div>

- 終端記号は `o`, `-`、`^v^v^v`、`+`、`|`、` ` からなる。
- 非終端記号および終端記号は高さと幅を持つ。
- `<回路>` は回路図全体を表す。`<始点>` と `<直列抵抗>` は `<始点>` の右端と `<直列抵抗>` の最も左上の位置を繋げる。`<直列抵抗>` と `<終点>` は `<直列抵抗>` の最も右上の位置と `<終点>` の左端を繋げる。
- `<直列抵抗>` は、`<並列抵抗>` であるか、`<並列抵抗>` と `<直列抵抗>` を終端文字 `---` で直列に結線したものである。`<並列抵抗>` と `---` は `<並列抵抗>` の最も右上の位置と `---` の左端を繋げる。`---` と `<直列抵抗>` は `---` の右端と `<直列抵抗>` の最も左上の位置を繋げる。
- `<並列抵抗>` は `<抵抗>` であるか、$2$ つ以上の `<直列抵抗>` を `+`、`|`、`-` で並列に結線したものである。`---` の右端と `<直列抵抗>` の左上を繋げる。それぞれの `<直列抵抗>` は高さと幅が異なる場合があるが、幅は `<直列抵抗>` の後に生成される `---` のハイフンの数を適当に**増やす**ことで、最も幅の大きい `<直列抵抗>` に対して右端の `+` が揃うように調整する。よって、ハイフンの長さは必ず $3$ 以上であり、最も幅の大きい `<直列抵抗>` の後に続くハイフンの数は $3$ である。高さは `|` と ` ` をそれぞれ延長することで調整する。具体例を図 2 に示す。入力例も参考にせよ。

<div align="center">

![並列(1)](https://hackmd.io/_uploads/B1AUmeoqyl.png)

図 2 : 並列抵抗の生成例

</div>

`<回路>` が示す始点と終点の間の合成抵抗は `<回路>` が生成する `<直列抵抗>` の合成抵抗です。

`<直列抵抗>` の合成抵抗は `<並列抵抗>` のみが生成される場合は、`<並列抵抗>` の合成抵抗です。そうでないとき、生成される `<並列抵抗>` と `<直列抵抗>` の合成抵抗の値をそれぞれ $R_1, R_2$ とすると、合成抵抗は $R_1 + R_2$ となります。

`<並列抵抗>` の合成抵抗は、 `<抵抗>` のみが生成される場合の合成抵抗は $1$ です。そうでないとき、生成される $t$ 個の直列抵抗の合成抵抗の値をそれぞれ $R_1, R_2, \dots, R_t$ とすると、合成抵抗は $\displaystyle \frac{1}{\frac{1}{R_1} + \frac{1}{R_2} + \cdots + \frac{1}{R_t}}$ です。


`<回路>` に従う $N$ 行からなる文字列 $S$ が与えられます。$S$ の示す回路図の始点と終点の間の合成抵抗を $\mathrm{mod}\ 998244353$ で求めてください。

## 注記

### $\mathrm{mod}\ 998244353$ で求めるとは

求める合成抵抗は必ず有理数となることが証明できます。またこの問題の制約下では、その値を互いに素な $2$ つの整数 $P, Q$ を用いて $\frac{P}{Q}$ と表したとき、$R \times Q \equiv P \pmod{998244353}$ かつ $0 \leq R < 998244353$ を満たす整数 $R$ がただ一つ存在することが証明できます。この $R$ を求めてください。


## 制約

- $N$ は整数
- $S$ は図 1 の `<回路>` に従う
- $i$ 行目の文字列の長さを $|S_i|$ として、$N \times \underset{1 \le i \le N}{\max} |S_i| \leq {@constraints.S_MAX}$

### 部分点

この問題に部分点は存在しません。

## 入力

入力は以下の形式で標準入力から与えられます。

<div class="code-math">

$N$
$S_1$
$\vdots$
$S_N$
    
</div>

## 出力

答えを標準出力に出力してください。

{@samples.all}
